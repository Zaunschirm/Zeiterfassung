- name: Ping Supabase healthcheck
  run: |
    set -e

    BASE_URL="$(echo "${{ secrets.KEEPALIVE_SUPABASE_URL }}" | tr -d '\r\n' | sed 's:/*$::')"
    ANON_KEY="${{ secrets.KEEPALIVE_SUPABASE_ANON_KEY }}"

    URL="$BASE_URL/rest/v1/healthcheck?select=id&limit=1"

    echo "Pinging: $URL"

    curl -sS -o /dev/null -w "%{http_code}\n" \
      -H "apikey: $ANON_KEY" \
      -H "Authorization: Bearer $ANON_KEY" \
      -H "Accept: application/json" \
      "$URL"
